<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>íê¸°ë„ì„œ ë„ì„œê´€ Â· ëª¨ë°”ì¼ ìµœì í™” MVP</title>
  <meta name="theme-color" content="#111111" />
  <style>
    /* ===================== ëª¨ë°”ì¼ í¼ìŠ¤íŠ¸ í† í° ===================== */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    :root{
      --bg:#0b0b0c; --fg:#111; --txt:#101010; --muted:#667085;
      --card:#ffffff; --border:#e6e7ea; --shadow:0 6px 24px rgba(0,0,0,.08);
      --accent:#111111; --accent-2:#16a34a;
      --radius:16px; --radius-lg:22px;
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --chip:#f5f5f6;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo", sans-serif;
      color: #111; background: #fafafa;
      -webkit-tap-highlight-color: transparent;
    }
    img{max-width:100%; display:block}
    a { color: inherit; text-decoration: none; }
    button { cursor: pointer; }
    /* ì ‘ê·¼ì„± */
    :focus-visible { outline: 3px solid #111; outline-offset: 2px; border-radius: 10px; }
    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
    }

    /* ===================== ë ˆì´ì•„ì›ƒ ===================== */
    .container { max-width: 1120px; margin: 0 auto; padding: 0 16px; }
    header {
      position: sticky; top: 0; z-index: 20;
      backdrop-filter: blur(8px);
      background: rgba(255,255,255,.9);
      border-bottom: 1px solid var(--border);
      padding-top: calc(8px + var(--safe-top));
    }
    .nav { display:flex; align-items:center; justify-content:space-between; gap: 12px; padding: 8px 0 12px; }
    .brand { display:flex; align-items:center; gap:10px }
    .brand-badge{
      width:44px; height:44px; border-radius:13px; background:#fff; color:#fff; display:grid; place-items:center; box-shadow: var(--shadow); border:1px solid var(--border);
    }
    .brand-badge svg{ width:30px; height:30px; }
    .brand h1{ font-size:18px; margin:0; font-weight:900; line-height:1}
    .brand p{ margin:2px 0 0; font-size:12px; color: var(--muted); }

    /* ë°ìŠ¤í¬í†± íƒ­ */
    .tabs-desktop{ display:none; gap:8px; flex-wrap:wrap }
    .chip{ padding:10px 14px; min-height:44px; border-radius:14px; border:1px solid var(--border); background:var(--chip); font-weight:800; font-size:14px; }
    .chip.active{ background: var(--accent); color:#fff; border-color: var(--accent); }

    /* ìƒë‹¨ ë³´ì¡° */
    .points{
      display:inline-flex; align-items:center; gap:8px;
      background: var(--accent); color:#fff; padding:10px 14px; min-height:44px; border-radius:14px; box-shadow: var(--shadow);
      font-weight:800; font-size:13px;
    }
    .points .muted{ font-weight:600; opacity:.9 }
    .points button{
      font-size:12px; background: rgba(255,255,255,.15); border:0; color:#fff; padding:8px 10px; border-radius:10px;
      min-height:36px;
    }

    main{ padding: 20px 0 96px; } /* í•˜ë‹¨ ê³ ì •íƒ­ ë†’ì´ë§Œí¼ ì—¬ë°± */
    section{ margin-bottom: 28px; }

    /* ì¹´ë“œ/ë²„íŠ¼ ê³µí†µ */
    .card{ background: var(--card); border:1px solid var(--border); border-radius: var(--radius-lg); box-shadow: var(--shadow); }
    .btn{
      padding:14px 16px; min-height:48px; border-radius: 16px; border:1px solid var(--border); background:#fff; font-weight:800;
      font-size:15px;
    }
    .btn.primary{ background: var(--accent); color:#fff; border-color: var(--accent); }
    .btn.success{ background: var(--accent-2); color:#fff; border-color: var(--accent-2); }
    .btn:disabled{ opacity:.5; cursor:not-allowed }

    /* ê·¸ë¦¬ë“œ */
    .grid{ display:grid; gap:14px }
    .grid-2{ grid-template-columns: 1fr; }
    .grid-3{ grid-template-columns: 1fr; }
    @media (min-width: 680px) {
      .tabs-desktop{ display:flex }
      .grid-2{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (min-width: 980px) {
      .grid-3{ grid-template-columns: repeat(3, minmax(0,1fr)); }
    }

    /* í™ˆ íˆì–´ë¡œ */
    .hero{ display:grid; grid-template-columns: 1fr; gap:16px; align-items:center; position:relative }
    .hero h2{ font-size: clamp(24px, 5.2vw, 40px); margin:0; font-weight:900; line-height:1.15; letter-spacing:-.2px }
    .hero p{ color: var(--muted); margin:10px 0 0; font-size:15px }
    .hero-cta{ display:flex; gap:10px; margin-top:14px; flex-wrap:wrap }
    .stats{ display:grid; grid-template-columns: repeat(3,1fr); gap:8px; }
    .stat{ background:#f4f4f5; border-radius:14px; padding:10px; text-align:center; }
    .stat p{ margin:0; font-size:12px; color:var(--muted) }
    .stat strong{ display:block; margin-top:4px; font-size:18px }

    /* ì‘ì€ ìœ„ì ¯(ìš°ìƒë‹¨/ìš°í•˜ë‹¨) */
    .floating{
      position:absolute; right:0; display:grid; gap:8px;
      width:min(100%, 280px);
    }
    .widget{ background:#fff; border:1px solid var(--border); border-radius:14px; padding:10px; box-shadow: var(--shadow) }
    .widget h5{ margin:0 0 6px; font-size:13px; font-weight:900; display:flex; align-items:center; gap:6px }
    .rank li{ display:flex; justify-content:space-between; gap:8px; padding:6px 0; border-bottom:1px dashed #eee; font-size:12px }
    .rank li:last-child{ border-bottom:none }
    .pill{ display:inline-flex; align-items:center; gap:6px; padding:6px 8px; border:1px solid var(--border); border-radius:999px; font-size:12px; background:#fff }

    /* ê²€ìƒ‰ ì„¹ì…˜ */
    .toolbar{ display:grid; gap:12px; align-items:stretch }
    .field label{ display:block; font-size:13px; font-weight:800 }
    .field input, .field select, .field textarea{
      width:100%; margin-top:6px; padding:14px 14px; border-radius:14px; border:1px solid var(--border); outline: none; font-size:16px; /* iOS ì¤Œ ë°©ì§€ */
    }
    .categories{ display:flex; gap:8px; flex-wrap:wrap }
    .book{ overflow:hidden }
    .book .meta{ padding:12px 14px }
    .book h3{ margin:0; font-size:16px; line-height:1.35 }
    .meta-sub{ color: var(--muted); font-size:13px }

    /* í•˜ë‹¨ ê³ ì • ëª¨ë°”ì¼ íƒ­ */
    .bottom-nav{
      position: fixed; left: 0; right: 0; bottom: 0; z-index: 30;
      padding: 8px 12px calc(8px + var(--safe-bottom));
      background: rgba(255,255,255,.96);
      border-top: 1px solid var(--border);
      display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;
      backdrop-filter: blur(8px);
    }
    .tab-btn{
      display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px;
      border:1px solid var(--border); background:#fff; border-radius:12px; min-height:48px; font-size:12px; font-weight:800;
    }
    .tab-btn.active{ background:#111; color:#fff; border-color:#111; }

    /* ëª¨ë‹¬ */
    .modal{
      position: fixed; inset: 0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,.45);
      padding:16px; z-index: 50;
    }
    .modal.open{ display:flex }
    .modal .panel{ max-width: 640px; width:100%; background:#fff; border-radius: 20px; padding:18px; box-shadow: var(--shadow); }

    footer{ border-top:1px solid var(--border); padding: 22px 0 calc(22px + var(--safe-bottom)); color: var(--muted); font-size:14px; }
    .tooltip{ position:relative; cursor:help; border-bottom:1px dotted #aaa }
    .tooltip:hover .tip{ opacity:1; transform: translateY(0) }
    .tip{ position:absolute; left:0; right:auto; top:120%; z-index:10; background:#111; color:#fff; padding:8px 10px; border-radius:10px; font-size:12px; width:240px; opacity:0; transform: translateY(6px); transition:.2s; }
    @media (min-width:980px){
      .floating{ top:0 }
    }

    /* ìœ„ì ¯ì´ í•­ìƒ ê°€ì¥ ìœ„ì— ì˜¤ë„ë¡ */
    .floating{ z-index: 6; }

    /* í™ˆ ì´ë¯¸ì§€ í•˜ë‹¨ ì˜¤ë²„ë ˆì´ ì¹´ë“œê°€ ìœ„ì ¯ì„ ê°€ë¦¬ì§€ ì•Šë„ë¡ */
    .hero-overlay{ z-index: 1; }

    @media (max-width: 979px){
      .floating{
        position: static;
        width: 100%;
        margin-top: 8px;
      }
    }

    /* ê¸°ë¶€ì ë­í¬ì— ì—¬ë°± */
    #rankDonors{ margin-bottom: 4px; }
  </style>
</head>
<body>
  <!-- =================== í—¤ë” =================== -->
  <header>
    <div class="container nav" role="navigation" aria-label="ì£¼ìš” ë©”ë‰´">
      <div class="brand">
        <!-- (4) ì •ë¶€ë§ˆí¬ ëŠë‚Œì˜ 'íƒœê·¹+ì±…' SVG ë°°ì§€ -->
        <div class="brand-badge" aria-hidden="true" title="íƒœê·¹+ì±… ì‹¬ë²Œ(ì‹œì•ˆ)">
          <svg viewBox="0 0 64 64" role="img" aria-label="íƒœê·¹ ë¬¸ì–‘ê³¼ ì±…">
            <!-- ì±… -->
            <rect x="10" y="30" width="44" height="18" rx="4" fill="#16a34a" opacity=".15" />
            <path d="M12 30h40v12c-8 0-16 6-20 6s-12-6-20-6V30z" fill="#16a34a"/>
            <!-- íƒœê·¹ -->
            <circle cx="32" cy="20" r="10" fill="#fff" stroke="#111" stroke-width="2"/>
            <path d="M22 20a10 10 0 0 1 18-6 7 7 0 1 0 0 12 10 10 0 0 1-18-6z" fill="#e11d48"/>
            <path d="M42 20a10 10 0 0 1-18 6 7 7 0 1 0 0-12 10 10 0 0 1 18 6z" fill="#2563eb"/>
          </svg>
        </div>
        <div>
          <h1>íê¸°ë„ì„œ ë„ì„œê´€</h1>
          <p>Discarded Books Library Â· Carbon Neutral</p>
        </div>
      </div>

      <div class="tabs-desktop" id="tabsDesktop"></div>

      <div style="display:flex; align-items:center; gap:10px">
        <div class="points" id="points">
          <span class="muted">í¬ì¸íŠ¸</span>
          <span id="pointsVal">360p</span>
          <button id="add100" title="+100 í¬ì¸íŠ¸ ì¶©ì „ (ì‹œë®¬)">+100</button>
        </div>
      </div>
    </div>
  </header>

  <!-- =================== ë³¸ë¬¸ =================== -->
  <main class="container">
    <!-- í™ˆ -->
    <section id="home">
      <div class="hero">
        <div>
          <h2>íê¸°ë„ì„œì˜ <span style="color:#166534">ë‘ ë²ˆì§¸ ì‚¶</span>ì„ ì—´ë‹¤</h2>
          <p>ì œì Â·íê¸°ëœ ì±…ì„ ìˆ˜ì§‘Â·ì •ë¦¬í•´ ì‹œë¯¼ì—ê²Œ ë‹¤ì‹œ ì—°ê²°í•©ë‹ˆë‹¤. íƒ„ì†Œì¤‘ë¦½ í¬ì¸íŠ¸ë¡œ í•©ë¦¬ì ìœ¼ë¡œ ì´ìš©í•˜ê³ ,
            ë…ì„œê°€ ê³§ ì¹œí™˜ê²½ ì‹¤ì²œì´ ë˜ëŠ” ê²½í—˜ì„ ë§Œë‚˜ë³´ì„¸ìš”.</p>
          <div class="hero-cta">
            <button class="btn primary" id="ctaSearch">ì§€ê¸ˆ ê²€ìƒ‰í•˜ê¸°</button>
            <a class="btn" href="#how">ì´ìš©ì•ˆë‚´ ë³´ê¸°</a>
            <!-- (2) ì¸ì„¼í‹°ë¸Œ ì•ˆë‚´ ë¹ ë¥¸ ì´ë™ -->
            <a class="btn" href="#incentives">ì¸ì„¼í‹°ë¸Œ ë³´ê¸°</a>
          </div>
          <div class="grid stats" style="margin-top:14px">
            <div class="stat">
              <p>ëˆ„ì  ë³´ì¡´ ë„ì„œ</p>
              <strong>128,420ê¶Œ</strong>
            </div>
            <div class="stat">
              <p class="tooltip">ì¶”ì • COâ‚‚ ê°ì¶•
                <span class="tip">62.3t COâ‚‚ëŠ” ì„±ì¸ ì•½ 40~50ëª… 1ë…„ ê°€ì • ì „ë ¥ ì‚¬ìš©ëŸ‰ì— ê·¼ì ‘(ê°œëµ í™˜ì‚°)</span>
              </p>
              <strong>62.3t</strong>
            </div>
            <div class="stat"><p>ì´ë²ˆ ì£¼ ê¸°ì¦</p><strong>1,204ê¶Œ</strong></div>
          </div>
        </div>

        <!-- (5)(6) ìš°ìƒë‹¨ ë­í¬ & ìš°í•˜ë‹¨ ê¸°ë¶€ì ìœ„ì ¯ -->
        <div class="floating" style="margin-top:8px">
          <div class="widget" aria-live="polite">
            <h5>ğŸ“ˆ ì¸ê¸° ëŒ€ì¶œ TOP 5</h5>
            <ol class="rank" id="rankLoans"></ol>
          </div>
          <div class="widget">
            <h5>ğŸ›’ ì¸ê¸° íŒë§¤ TOP 5</h5>
            <ol class="rank" id="rankSales"></ol>
          </div>
          <div class="widget" style="opacity:.95">
            <h5>ğŸ—ï¸ ì´ë‹¬ì˜ ê¸°ë¶€ì</h5>
            <ol class="rank" id="rankDonors"></ol>
          </div>
        </div>

        <div style="position:relative">
          <img
            src="https://images.unsplash.com/photo-1532012197267-da84d127e765?q=80&w=1600&auto=format&fit=crop"
            alt="ì„œê°€ì— ê½‚íŒ ë‹¤ì–‘í•œ ì±…"
            class="card"
            loading="lazy"
            width="1200" height="360"
            style="height: 360px; object-fit: cover; border-radius: 24px;">
          <!-- ê¸°ì¡´: <div class="card" ... -->
          <div class="card hero-overlay" style="position:absolute; left:12px; right:12px; bottom:-14px; padding:12px; border-radius: 18px;">
            <div class="grid" style="grid-template-columns: repeat(3,1fr); gap:8px">
              <div class="stat"><p>ì˜¤ëŠ˜ ì´ìš©ì</p><strong>342ëª…</strong></div>
              <div class="stat"><p>í‰ê·  ëŒ€ì—¬ê¶Œìˆ˜</p><strong>2.2ê¶Œ</strong></div>
              <div class="stat"><p>ê¸°ì¦ ëŒ€ê¸°</p><strong>86ê±´</strong></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ê²€ìƒ‰ -->
    <section id="search" hidden>
      <div class="toolbar">
        <div class="field">
          <label for="q">ë„ì„œ ê²€ìƒ‰</label>
          <input id="q" placeholder="ì œëª©/ì €ì/ì—°ë„/ë¶„ì•¼/ì‹­ì§„ë¶„ë¥˜ì½”ë“œ(ì˜ˆ: 300, 821)ë¡œ ê²€ìƒ‰" inputmode="search" />
        </div>

        <!-- (3) ì‹­ì§„ë¶„ë¥˜ì²´ê³„(ê°„ëµ DDC/KDC ê³µí†µ 10ëŒ€ë¥˜) í•„í„° -->
        <div>
          <p style="margin:0 0 6px; font-weight:800; font-size:13px">ì‹­ì§„ë¶„ë¥˜(ëŒ€ë¥˜)</p>
          <div class="categories" id="ddcCats"></div>
        </div>

        <div>
          <p style="margin:0 0 6px; font-weight:800; font-size:13px">ë¶„ì•¼</p>
          <div class="categories" id="categories"></div>
        </div>
        <div>
          <button class="btn success" id="borrowBtn" disabled>ì„ íƒ ëŒ€ì—¬ (ìµœëŒ€ 3ê¶Œ)</button>
        </div>
      </div>

      <div class="grid grid-3" id="results" style="margin-top:12px"></div>
    </section>

    <!-- ì´ìš© ì•ˆë‚´ -->
    <section id="how" hidden>
      <h3 style="font-size:20px; font-weight:900; margin:0 0 10px">ì´ìš© ì•ˆë‚´</h3>
      <div class="grid" style="grid-template-columns: 1fr; gap:10px">
        <div class="card" style="padding:14px">
          <p style="color:var(--muted); font-size:12px; margin:0 0 4px">STEP 1</p>
          <p style="font-weight:900; margin:0">ê²€ìƒ‰/ì˜ˆì•½</p>
          <p style="color:var(--muted); font-size:14px">ì˜¨ë¼ì¸ì—ì„œ íê¸°ë„ì„œë¥¼ ê²€ìƒ‰í•˜ê³  ê°€ê¹Œìš´ ê±°ì ì— ì˜ˆì•½í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="card" style="padding:14px">
          <p style="color:var(--muted); font-size:12px; margin:0 0 4px">STEP 2</p>
          <p style="font-weight:900; margin:0">ë°©ë¬¸/ì…ì¥</p>
          <p style="color:var(--muted); font-size:14px">ê±°ì  ë„ì„œê´€ ë°©ë¬¸ í›„ íƒ„ì†Œì¤‘ë¦½ í¬ì¸íŠ¸ë¡œ ì…ì¥í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="card" style="padding:14px">
          <p style="color:var(--muted); font-size:12px; margin:0 0 4px">STEP 3</p>
          <p style="font-weight:900; margin:0">ì„ íƒ/ì†Œì¥</p>
          <p style="color:var(--muted); font-size:14px">1íšŒ 100 í¬ì¸íŠ¸ë¡œ ë‹¹ì¼ ìµœëŒ€ 3ê¶Œê¹Œì§€ ì†Œì¥/ëŒ€ì—¬í•  ìˆ˜ ìˆì–´ìš”.</p>
        </div>
        <div class="card" style="padding:14px">
          <p style="color:var(--muted); font-size:12px; margin:0 0 4px">STEP 4</p>
          <p style="font-weight:900; margin:0">ê³µìœ /ê¸°ì¦</p>
          <p style="color:var(--muted); font-size:14px">ë‹¤ ì½ì€ ì±…ì€ ë‹¤ì‹œ ê¸°ì¦í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì´ìš©ìì—ê²Œ ìˆœí™˜í•´ìš”.</p>
        </div>
      </div>
    </section>

    <!-- (2) ì¸ì„¼í‹°ë¸Œ -->
    <section id="incentives" hidden>
      <h3 style="font-size:20px; font-weight:900; margin:0 0 10px">ê¸°ì¦ ì¸ì„¼í‹°ë¸Œ</h3>
      <div class="grid grid-2">
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 8px">í¬ì¸íŠ¸ & í˜œíƒ</h4>
          <ul style="margin:0; padding-left:18px; color:var(--muted); font-size:14px">
            <li><b>ê¸°ì¦ ì ë¦½:</b> ê¶Œë‹¹ 20p (ìƒíƒœ/ìˆ˜ìš” ê°€ì¤‘ì¹˜ ì ìš©)</li>
            <li><b>ì›”ê°„ ë°°ì§€:</b> â€˜ê·¸ë¦° ê¸°ë¶€ìâ€™, â€˜ìŠˆí¼ ì„œí¬í„°â€™ ë“± ë ˆë²¨ ë¶€ì—¬</li>
            <li><b>ì œíœ´ ì¿ í°:</b> ì¹œí™˜ê²½ ì¹´í˜/ì„œì  í• ì¸ ì¿ í° ìë™ ë°œê¸‰</li>
            <li><b>ìš°ì„  ì…ì¥:</b> ì¸ê¸° íƒ€ì„ ìŠ¬ë¡¯ ìš°ì„  ì˜ˆì•½ê¶Œ</li>
            <li><b>ê¸°ë¶€ ì¦ì„œ:</b> PDF ì˜ìˆ˜ì¦(ê¸°ê´€ í˜‘ë ¥ ì‹œ ê¸°ë¶€ê¸ˆ ì˜ìˆ˜ì¦ ì „í™˜ ê°€ëŠ¥)</li>
          </ul>
          <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
            <span class="pill">ğŸ… ê·¸ë¦° ë°°ì§€</span>
            <span class="pill">ğŸŸï¸ ìš°ì„  ì…ì¥</span>
            <span class="pill">ğŸ§¾ ê¸°ë¶€ ì¦ì„œ</span>
            <span class="pill">â˜• ì œíœ´ ì¿ í°</span>
          </div>
        </div>
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 8px">ì¸ì„¼í‹°ë¸Œ ê·œì •(ìš”ì•½)</h4>
          <p style="color:var(--muted); font-size:14px">
            ë°˜ì… ì‹¬ì‚¬ í†µê³¼ ìë£Œì— í•œí•´ ì ë¦½ë©ë‹ˆë‹¤. í›¼ì†/ë¶ˆë²•ë³µì œ/ì €ì‘ê¶Œ ë¬¸ì œ ìë£ŒëŠ” ë°˜ì… ë¶ˆê°€í•˜ë©°, ì ë¦½ë„ ì œí•œë©ë‹ˆë‹¤.
            ì„¸ë¶€ ê·œì •ì€ ì¶”í›„ ê³ ì‹œí•©ë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </section>

    <!-- ê±°ì  ë„ì„œê´€ -->
    <section id="branches" hidden>
      <h3 style="font-size:20px; font-weight:900; margin:0 0 10px">ê±°ì  ë„ì„œê´€(ëŒ€í•œë¯¼êµ­ ê´‘ì—­ìì¹˜ë‹¨ì²´)</h3>
      <p class="meta-sub" style="margin:0 0 8px">â€» ë„ ë‹¨ìœ„ëŠ” ë„ì²­ ì†Œì¬ì§€(í–‰ì •ì¤‘ì‹¬)ì— ì„¤ì¹˜</p>
      <div class="grid grid-3" id="branchList"></div>
    </section>

    <!-- ê¸°ì¦ ì‹ ì²­ -->
    <section id="donate" hidden>
      <h3 style="font-size:20px; font-weight:900; margin:0 0 10px">ë„ì„œ ê¸°ì¦ ì‹ ì²­</h3>
      <form class="card" id="donateForm" style="padding:14px; max-width:760px">
        <div class="field">
          <label for="name">ê¸°ì¦ì ì„±ëª…</label>
          <input id="name" required>
        </div>
        <div class="grid grid-2" style="margin-top:8px">
          <div class="field">
            <label for="email">ì´ë©”ì¼</label>
            <input id="email" type="email" required>
          </div>
          <div class="field">
            <label for="phone">ì—°ë½ì²˜</label>
            <input id="phone" required>
          </div>
        </div>
        <div class="field" style="margin-top:8px">
          <label for="list">ê¸°ì¦ ëª©ë¡ (ì œëª©/ì €ì/ë°œí–‰ì—°ë„/ì‹­ì§„ë¶„ë¥˜ì½”ë“œ)</label>
          <textarea id="list" rows="5" placeholder="ì˜ˆ) ê³ ì „ë¬¸í•™ ì‚°ì±… / ìµœì€ì§€ / 2008 / 820&#10;ì§€êµ¬ë¥¼ êµ¬í•˜ëŠ” ì‘ì€ ë…ì„œ / ê¹€í•˜ëŠ˜ / 2017 / 300"></textarea>
        </div>
        <div class="grid grid-2" style="margin-top:8px">
          <div class="field">
            <label for="pickup">ìˆ˜ê±° ë°©ì‹</label>
            <select id="pickup">
              <option>ê±°ì  ë°©ë¬¸</option>
              <option>íƒë°° ìˆ˜ê±° ì‹ ì²­</option>
            </select>
          </div>
          <div class="field">
            <label for="branchSel">ê±°ì  ì„ íƒ</label>
            <select id="branchSel"></select>
          </div>
        </div>
        <div style="display:flex; align-items:center; gap:8px; margin-top:8px">
          <input id="agree" type="checkbox" required>
          <label for="agree" style="color:var(--muted); font-size:14px">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ê¸°ì¦ ì‹¬ì‚¬ ê¸°ì¤€ì— ë™ì˜í•©ë‹ˆë‹¤.</label>
        </div>
        <div style="display:flex; justify-content:flex-end; margin-top:12px">
          <button class="btn success" type="submit">ê¸°ì¦ ì‹ ì²­</button>
        </div>
      </form>
      <div class="card" id="donateDone" hidden style="padding:14px; max-width:760px; background:#f0fdf4; border-color:#bbf7d0; margin-top:10px">
        <strong>ì‹ ì²­ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.</strong>
        <p style="margin:6px 0 0; color:var(--muted)">í‰ê·  3ì˜ì—…ì¼ ì´ë‚´ì— ë‹´ë‹¹ìê°€ ì—°ë½ë“œë¦½ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.</p>
      </div>
    </section>

    <!-- (8) ì •ë³´/ë²•ì•ˆ ìš”ì•½ -->
    <section id="info" hidden>
      <h3 style="font-size:20px; font-weight:900; margin:0 0 10px">ì •ë³´ Â· ë²•ì•ˆ ìš”ì•½</h3>
      <div class="grid grid-2">
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 6px">ë¬¸ì œìƒí™©</h4>
          <ul style="margin:0; padding-left:18px; color:var(--muted)">
            <li>ë„ì„œê´€ ì œì Â·íê¸° ìë£Œì˜ ì²´ê³„ì  ìˆœí™˜ ë¶€ì¡±</li>
            <li>ë³´ì¡´/ìˆœí™˜ ë¹„ìš© ëŒ€ë¹„ ì‹œë¯¼ ì ‘ê·¼ì„± ë‚®ìŒ</li>
            <li>ESGÂ·íƒ„ì†Œì¤‘ë¦½ í™œë™ê³¼ì˜ ì—°ê²° ê³ ë¦¬ ë¯¸í¡</li>
          </ul>
        </div>
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 6px">í•´ê²°ë°©ì•ˆ: íê¸°ë„ì„œ ë„ì„œê´€</h4>
          <ul style="margin:0; padding-left:18px; color:var(--muted)">
            <li>ê´‘ì—­ìì¹˜ë‹¨ì²´ ê±°ì  ì„¤ì¹˜ Â· ë””ì§€í„¸ ê²€ìƒ‰/ì—´ëŒ ì‹œìŠ¤í…œ</li>
            <li>íƒ„ì†Œì¤‘ë¦½ í¬ì¸íŠ¸ ê²°ì œ ì—°ë™(ì…ì¥ 100p, 1ì¼ 3ê¶Œ)</li>
            <li>ê¸°ì¦ ì¸ì„¼í‹°ë¸Œ(í¬ì¸íŠ¸/ë°°ì§€/ì¿ í°)ë¡œ ìˆœí™˜ ì´‰ì§„</li>
          </ul>
        </div>
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 6px">ê¸°ëŒ€ íš¨ê³¼</h4>
          <ul style="margin:0; padding-left:18px; color:var(--muted)">
            <li>ë¬¸í™” ì ‘ê·¼ì„± í™•ëŒ€ì™€ ì±… ìƒì• ì£¼ê¸° ì—°ì¥</li>
            <li>íê¸°ë¬¼ ê°ì¶• ë° COâ‚‚ ê°ì¶•(í™˜ê²½íš¨ê³¼ ê°€ì‹œí™”)</li>
            <li>ë¯¼ê´€ í˜‘ë ¥ ESG ìº í˜ì¸ ì´‰ì§„</li>
          </ul>
        </div>
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 6px">ì£¼ìš” ì¡°í•­(ìš”ì•½)</h4>
          <ul style="margin:0; padding-left:18px; color:var(--muted)">
            <li>ê´‘ì—­ ë‹¨ìœ„ 1ê°œì†Œ ì´ìƒ ì„¤ì¹˜(ë¬¸ì²´ë¶€ ì´ê´„Â·í™˜ê²½ë¶€ í˜‘ë ¥)</li>
            <li>í¬ì¸íŠ¸ ë¶€ì¡± ì‹œ ëŒ€ì²´ ê²°ì œ ê°€ëŠ¥, ì‹¤ì  í™˜ê²½ë¶€ ì—°ë™</li>
            <li>ë””ì§€í„¸ ì‹œìŠ¤í…œ êµ¬ì¶•Â·ìš´ì˜(ê²€ìƒ‰/ì˜ˆì•½/ì—´ëŒ/ê¸°ì¦)</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- (7) ê¸°ì¡´ ë²•ë¥ (ì•ˆ) ì„¹ì…˜ ìœ ì§€ -->
    <section id="law" hidden>
      <h3 style="font-size:20px; font-weight:900; margin:0 0 10px">ë²•ë¥ (ì•ˆ) í•µì‹¬ ìš”ì•½</h3>
      <div class="grid grid-2">
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 6px">ëª©ì </h4>
          <p style="color:var(--muted)">íê¸°ë„ì„œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ìˆ˜ì§‘Â·ê´€ë¦¬í•˜ì—¬ êµ­ë¯¼ì—ê²Œ ì œê³µí•˜ê³ , íƒ„ì†Œì¤‘ë¦½ í¬ì¸íŠ¸ ì œë„ì™€ ì—°ê³„í•˜ì—¬ ì§€ì†ê°€ëŠ¥í•œ ë¬¸í™” í–¥ìœ ì™€ íƒ„ì†Œì¤‘ë¦½ ì‚¬íšŒ êµ¬í˜„ì— ê¸°ì—¬í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="card" style="padding:14px">
          <h4 style="margin:0 0 6px">ì£¼ìš” ì¡°í•­</h4>
          <ul style="margin:0; padding-left:18px; color:var(--muted)">
            <li>ê´‘ì—­ìì¹˜ë‹¨ì²´ë³„ 1ê°œì†Œ ì´ìƒ ì„¤ì¹˜, ë¬¸ì²´ë¶€ ì´ê´„Â·í™˜ê²½ë¶€ í˜‘ë ¥</li>
            <li>ì…ì¥ë£ŒëŠ” íƒ„ì†Œì¤‘ë¦½ í¬ì¸íŠ¸ ë‚©ë¶€ê°€ ì›ì¹™</li>
            <li>1íšŒ 100í¬ì¸íŠ¸ë¡œ ë‹¹ì¼ ìµœëŒ€ 3ê¶Œ ì†Œì¥/ëŒ€ì—¬</li>
            <li>í¬ì¸íŠ¸ ë¶€ì¡± ì‹œ í˜„ê¸ˆ ë“± ëŒ€ì²´ ê²°ì œ ê°€ëŠ¥</li>
            <li>ì´ìš© ì‹¤ì ì€ í™˜ê²½ë¶€ ìš´ì˜ì²´ê³„ì— ì—°ë™</li>
            <li>ë””ì§€í„¸ ì •ë³´ì‹œìŠ¤í…œ(ê²€ìƒ‰/ì—´ëŒ) êµ¬ì¶•Â·ìš´ì˜</li>
          </ul>
        </div>
      </div>
      <div class="card" style="padding:12px; margin-top:10px; background:#f4f4f5">
        <small style="color:var(--muted)">* ë³¸ í˜ì´ì§€ëŠ” ì´í•´ë¥¼ ë•ê¸° ìœ„í•œ ìš”ì•½ì…ë‹ˆë‹¤. ì •ì‹ ë‚´ìš©ì€ ê³ ì‹œë˜ëŠ” ì‹œí–‰ë ¹Â·ì‹œí–‰ê·œì¹™ì„ ë”°ë¦…ë‹ˆë‹¤.</small>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq" hidden>
      <h3 style="font-size:20px; font-weight:900; margin:0 0 10px">FAQ</h3>
      <details class="card" style="padding:14px; margin-bottom:8px">
        <summary style="font-weight:900; cursor:pointer">íê¸°ë„ì„œëŠ” ì–´ë””ì„œ ì˜¤ë‚˜ìš”?</summary>
        <p style="color:var(--muted); font-size:14px">ê³µê³µ/í•™êµ/ëŒ€í•™ ë„ì„œê´€ ë“±ì—ì„œ ë°œìƒí•œ ì œì Â·íê¸° ìë£Œë¥¼ ìˆ˜ì§‘Â·ì •ë¦¬í•˜ì—¬ ì œê³µí•©ë‹ˆë‹¤.</p>
      </details>
      <details class="card" style="padding:14px; margin-bottom:8px">
        <summary style="font-weight:900; cursor:pointer">í¬ì¸íŠ¸ëŠ” ì–´ë””ì„œ í™•ì¸í•˜ë‚˜ìš”?</summary>
        <p style="color:var(--muted); font-size:14px">ì •ë¶€ í†µí•© íƒ„ì†Œì¤‘ë¦½ í¬ì¸íŠ¸ ê³„ì •ê³¼ ì—°ë™ë˜ë©°, ë§ˆì´í˜ì´ì§€ì—ì„œ ì”ì—¬ í¬ì¸íŠ¸ì™€ ì´ìš© ë‚´ì—­ì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.</p>
      </details>
      <details class="card" style="padding:14px;">
        <summary style="font-weight:900; cursor:pointer">ê¸°ì¦ ê¸°ì¤€ì€ ë¬´ì—‡ì¸ê°€ìš”?</summary>
        <p style="color:var(--muted); font-size:14px">ì €ì‘ê¶Œ/ìƒíƒœ/ìˆ˜ìš” ë“±ì„ ì¢…í•© ì‹¬ì‚¬í•´ ë°˜ì…í•©ë‹ˆë‹¤. ì†ìƒ ì‹¬í•˜ë©´ ë³´ì¡´ì²˜ë¦¬ ë˜ëŠ” ì¬í™œìš©í•©ë‹ˆë‹¤.</p>
      </details>
    </section>
  </main>

  <!-- =================== í•˜ë‹¨ ëª¨ë°”ì¼ íƒ­ =================== -->
  <nav class="bottom-nav" aria-label="í•˜ë‹¨ íƒ­" id="bottomNav"></nav>

  <!-- =================== ëª¨ë‹¬: ëŒ€ì—¬ =================== -->
  <div class="modal" id="borrowModal" role="dialog" aria-modal="true" aria-labelledby="borrowTitle">
    <div class="panel">
      <h4 id="borrowTitle" style="margin:0 0 6px; font-size:20px; font-weight:900">í¬ì¸íŠ¸ë¡œ ëŒ€ì—¬í•˜ê¸°</h4>
      <p id="borrowDesc" style="color:var(--muted); font-size:14px; margin: 0 0 14px">
        1íšŒ ì…ì¥ ì‹œ <b>100 í¬ì¸íŠ¸</b>ë¡œ <b>ë‹¹ì¼ ìµœëŒ€ 3ê¶Œ</b>ê¹Œì§€ ì†Œì¥/ëŒ€ì—¬í•  ìˆ˜ ìˆì–´ìš”.
      </p>
      <div style="display:flex; justify-content:flex-end; gap:8px">
        <button class="btn" id="cancelBorrow">ì·¨ì†Œ</button>
        <button class="btn success" id="confirmBorrow">100 í¬ì¸íŠ¸ ì°¨ê° í›„ ëŒ€ì—¬</button>
      </div>
    </div>
  </div>

  <!-- =================== ëª¨ë‹¬: ì§€ë„(9) =================== -->
  <div class="modal" id="mapModal" role="dialog" aria-modal="true" aria-labelledby="mapTitle">
    <div class="panel">
      <h4 id="mapTitle" style="margin:0 0 8px; font-size:20px; font-weight:900">ê¸¸ì°¾ê¸° ë¯¸ë¦¬ë³´ê¸°</h4>
      <div id="mapFrameWrap" class="card" style="padding:0; overflow:hidden; height:320px">
        <!-- OpenStreetMap ê²€ìƒ‰ ê²°ê³¼ë¥¼ iframeìœ¼ë¡œ ê°„ë‹¨ í”„ë¦¬ë·° (ì •í™• ì¢Œí‘œ ë¯¸ì§€ì • ì‹œ ê²€ìƒ‰í˜ì´ì§€ ì‚¬ìš©) -->
        <iframe id="mapFrame" title="ì§€ë„ ë¯¸ë¦¬ë³´ê¸°" style="width:100%; height:320px; border:0" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
      <p class="meta-sub" id="mapAddr" style="margin:8px 0 0"></p>
      <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:12px">
        <a class="btn" id="openMapNew" target="_blank" rel="noopener">ìƒˆ íƒ­ì—ì„œ ì—´ê¸°</a>
        <button class="btn primary" id="closeMap">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      â“’ <span id="year"></span> íê¸°ë„ì„œ ë„ì„œê´€ (MVP). ë³¸ ì„œë¹„ìŠ¤ëŠ” ì‹œë²” UIë¡œ ì‹¤ì œ ìš´ì˜ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>
  </footer>

  <script>
    // ======================= MOCK ë°ì´í„° =======================
    const CATEGORIES = ["ë¬¸í•™","ì—­ì‚¬","ê³¼í•™","ì˜ˆìˆ ","ì‚¬íšŒ","ê¸°ìˆ ","ì•„ë™","ê¸°íƒ€"];
    // (3) ì‹­ì§„ë¶„ë¥˜ ëŒ€ë¥˜(DDC/KDC ê³µí†µ 10ëŒ€ë¥˜)
    const DDC_TOP = [
      { code:"000", label:"ì´ë¥˜" }, { code:"100", label:"ì² í•™" }, { code:"200", label:"ì¢…êµ" },
      { code:"300", label:"ì‚¬íšŒê³¼í•™" }, { code:"400", label:"ì–¸ì–´" }, { code:"500", label:"ìì—°ê³¼í•™" },
      { code:"600", label:"ê¸°ìˆ ê³¼í•™" }, { code:"700", label:"ì˜ˆìˆ " }, { code:"800", label:"ë¬¸í•™" }, { code:"900", label:"ì—­ì‚¬" }
    ];

    const BOOKS = [
      { id:"b1", title:"ì§€êµ¬ë¥¼ êµ¬í•˜ëŠ” ì‘ì€ ë…ì„œ", author:"ê¹€í•˜ëŠ˜", year:2017, category:"ì‚¬íšŒ", condition:"ì–‘í˜¸", ddc:"300",
        cover:"https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop" },
      { id:"b2", title:"ì¤‘ê³ ì„œì ì˜ ê²½ì œí•™", author:"ì´ìˆ˜ë¹ˆ", year:2013, category:"ê¸°ìˆ ", condition:"ë³´í†µ", ddc:"600",
        cover:"https://images.unsplash.com/photo-1455884981818-54cb785db6fc?q=80&w=1200&auto=format&fit=crop" },
      { id:"b3", title:"ë„ì„œê´€ê³¼ íƒ„ì†Œì¤‘ë¦½", author:"ì •ë‹¤ì˜¨", year:2020, category:"ì‚¬íšŒ", condition:"ìµœìƒ", ddc:"020",
        cover:"https://images.unsplash.com/photo-1513475382585-d06e58bcb0ea?q=80&w=1200&auto=format&fit=crop" },
      { id:"b4", title:"ì•„ì´ì™€ í•¨ê»˜ ì½ëŠ” ê³¼í•™", author:"ë°•ìœ¤í˜¸", year:2015, category:"ê³¼í•™", condition:"ì–‘í˜¸", ddc:"500",
        cover:"https://images.unsplash.com/photo-1519682337058-a94d519337bc?q=80&w=1200&auto=format&fit=crop" },
      { id:"b5", title:"ê³ ì „ë¬¸í•™ ì‚°ì±…", author:"ìµœì€ì§€", year:2008, category:"ë¬¸í•™", condition:"ë³´í†µ", ddc:"820",
        cover:"https://images.unsplash.com/photo-1512820790803-83ca734da794?q=80&w=1200&auto=format&fit=crop" },
      { id:"b6", title:"ì˜ˆìˆ , ì§€ì†ê°€ëŠ¥ì„±ì„ ê·¸ë¦¬ë‹¤", author:"RYU", year:2019, category:"ì˜ˆìˆ ", condition:"ì–‘í˜¸", ddc:"700",
        cover:"https://images.unsplash.com/photo-1457694587812-e8bf29a43845?q=80&w=1200&auto=format&fit=crop" },
    ];

    // (1) ê´‘ì—­ìì¹˜ë‹¨ì²´ ê±°ì (ë„ëŠ” ë„ì²­ì†Œì¬ì§€ ê¸°ì¤€)
    const BRANCHES = [
      { id:"seoul",  name:"ì„œìš¸íŠ¹ë³„ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ì„œìš¸íŠ¹ë³„ì‹œ ì¤‘êµ¬ ì„¸ì¢…ëŒ€ë¡œ 110", phone:"02-123-4567", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"busan",  name:"ë¶€ì‚°ê´‘ì—­ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ë¶€ì‚°ê´‘ì—­ì‹œ ì—°ì œêµ¬ ì¤‘ì•™ëŒ€ë¡œ 1001", phone:"051-987-6543", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"daegu",  name:"ëŒ€êµ¬ê´‘ì—­ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ëŒ€êµ¬ê´‘ì—­ì‹œ ë¶êµ¬ ì—°ì•”ë¡œ 40", phone:"053-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"incheon",name:"ì¸ì²œê´‘ì—­ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ì¸ì²œê´‘ì—­ì‹œ ë‚¨ë™êµ¬ ì •ê°ë¡œ 29", phone:"032-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"gwangju",name:"ê´‘ì£¼ê´‘ì—­ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ê´‘ì£¼ê´‘ì—­ì‹œ ì„œêµ¬ ë‚´ë°©ë¡œ 111", phone:"062-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"daejeon",name:"ëŒ€ì „ê´‘ì—­ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë‘”ì‚°ë¡œ 100", phone:"042-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"ulsan",  name:"ìš¸ì‚°ê´‘ì—­ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ìš¸ì‚°ê´‘ì—­ì‹œ ë‚¨êµ¬ ì¤‘ì•™ë¡œ 201", phone:"052-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"sejong", name:"ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ íê¸°ë„ì„œ ë„ì„œê´€", address:"ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ í•œëˆ„ë¦¬ëŒ€ë¡œ 2130", phone:"044-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"gyeonggi",name:"ê²½ê¸°ë„ íê¸°ë„ì„œ ë„ì„œê´€(ìˆ˜ì›)", address:"ê²½ê¸°ë„ ìˆ˜ì›ì‹œ íŒ”ë‹¬êµ¬ íš¨ì›ë¡œ 1", phone:"031-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"gangwon",name:"ê°•ì›íŠ¹ë³„ìì¹˜ë„ íê¸°ë„ì„œ ë„ì„œê´€(ì¶˜ì²œ)", address:"ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì¶˜ì²œì‹œ ì¤‘ì•™ë¡œ 1", phone:"033-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"chungbuk",name:"ì¶©ì²­ë¶ë„ íê¸°ë„ì„œ ë„ì„œê´€(ì²­ì£¼)", address:"ì¶©ì²­ë¶ë„ ì²­ì£¼ì‹œ ìƒë‹¹êµ¬ ìƒë‹¹ë¡œ 82", phone:"043-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"chungnam",name:"ì¶©ì²­ë‚¨ë„ íê¸°ë„ì„œ ë„ì„œê´€(í™ì„±Â·ë‚´í¬)", address:"ì¶©ì²­ë‚¨ë„ í™ì„±êµ° í™ë¶ì ë‚´í¬ë¡œ 1", phone:"041-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"jeonbuk",name:"ì „ë¶íŠ¹ë³„ìì¹˜ë„ íê¸°ë„ì„œ ë„ì„œê´€(ì „ì£¼)", address:"ì „ë¶íŠ¹ë³„ìì¹˜ë„ ì „ì£¼ì‹œ ì™„ì‚°êµ¬ íš¨ìë¡œ 225", phone:"063-222-1122", hours:"í™”â€“ì¼ 10:00â€“18:00 (ì›” íœ´ê´€)" },
      { id:"jeonnam",name:"ì „ë¼ë‚¨ë„ íê¸°ë„ì„œ ë„ì„œê´€(ë¬´ì•ˆ)", address:"ì „ë¼ë‚¨ë„ ë¬´ì•ˆêµ° ì‚¼í–¥ì ì˜¤ë£¡ê¸¸ 1", phone:"061-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"gyeongbuk",name:"ê²½ìƒë¶ë„ íê¸°ë„ì„œ ë„ì„œê´€(ì•ˆë™)", address:"ê²½ìƒë¶ë„ ì•ˆë™ì‹œ í’ì²œë©´ ë„ì²­ëŒ€ë¡œ 455", phone:"054-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"gyeongnam",name:"ê²½ìƒë‚¨ë„ íê¸°ë„ì„œ ë„ì„œê´€(ì°½ì›)", address:"ê²½ìƒë‚¨ë„ ì°½ì›ì‹œ ì˜ì°½êµ¬ ì¤‘ì•™ëŒ€ë¡œ 300", phone:"055-000-0000", hours:"í™”â€“ì¼ 10:00â€“19:00 (ì›” íœ´ê´€)" },
      { id:"jeju",  name:"ì œì£¼íŠ¹ë³„ìì¹˜ë„ íê¸°ë„ì„œ ë„ì„œê´€(ì œì£¼)", address:"ì œì£¼íŠ¹ë³„ìì¹˜ë„ ì œì£¼ì‹œ ë¬¸ì—°ë¡œ 6", phone:"064-000-0000", hours:"í™”â€“ì¼ 10:00â€“18:00 (ì›” íœ´ê´€)" },
    ];

    // (5) ì¸ê¸° ëŒ€ì¶œ/íŒë§¤ Â· (6) ì´ë‹¬ì˜ ê¸°ë¶€ì
    const POPULAR_LOANS = [
      ["ë„ì„œê´€ê³¼ íƒ„ì†Œì¤‘ë¦½", 128], ["ê³ ì „ë¬¸í•™ ì‚°ì±…", 112], ["ì•„ì´ì™€ í•¨ê»˜ ì½ëŠ” ê³¼í•™", 98], ["ì§€êµ¬ë¥¼ êµ¬í•˜ëŠ” ì‘ì€ ë…ì„œ", 92], ["ì˜ˆìˆ , ì§€ì†ê°€ëŠ¥ì„±ì„ ê·¸ë¦¬ë‹¤", 81]
    ];
    const POPULAR_SALES = [
      ["ì¤‘ê³ ì„œì ì˜ ê²½ì œí•™", 76], ["ê³ ì „ë¬¸í•™ ì‚°ì±…", 55], ["ë„ì„œê´€ê³¼ íƒ„ì†Œì¤‘ë¦½", 52], ["ì•„ì´ì™€ í•¨ê»˜ ì½ëŠ” ê³¼í•™", 41], ["ì§€êµ¬ë¥¼ êµ¬í•˜ëŠ” ì‘ì€ ë…ì„œ", 39]
    ];
    const MONTH_DONORS = [
      ["ê¹€OO", 120], ["ì´OO", 88], ["ë°•OO", 70], ["ìµœOO", 62], ["ì •OO", 50]
    ];

    // ======================= ìƒíƒœ/DOM =======================
    const state = { active:"home", query:"", category:null, ddc:null, selected:new Set(), points:360 };
    const sections = ["home","search","how","incentives","branches","donate","info","law","faq"];

    const $ = id => document.getElementById(id);
    const yearEl = $("year");
    const qInput = $("q");
    const categoriesWrap = $("categories");
    const ddcCatsWrap = $("ddcCats");
    const resultsWrap = $("results");
    const borrowBtn = $("borrowBtn");
    const branchList = $("branchList");
    const donateForm = $("donateForm");
    const donateDone = $("donateDone");
    const branchSel = $("branchSel");
    const borrowModal = $("borrowModal");
    const cancelBorrow = $("cancelBorrow");
    const confirmBorrow = $("confirmBorrow");
    const pointsVal = $("pointsVal");
    const add100Btn = $("add100");
    const ctaSearchBtn = $("ctaSearch");
    const tabsDesktop = $("tabsDesktop");
    const bottomNav = $("bottomNav");

    const rankLoansEl = $("rankLoans");
    const rankSalesEl = $("rankSales");
    const rankDonorsEl = $("rankDonors");

    const mapModal = $("mapModal");
    const mapFrame = $("mapFrame");
    const mapAddr = $("mapAddr");
    const openMapNew = $("openMapNew");
    const closeMap = $("closeMap");

    const TAB_ITEMS = [
      ["home","í™ˆ"],["search","ê²€ìƒ‰"],["how","ì•ˆë‚´"],["incentives","ì¸ì„¼í‹°ë¸Œ"],["branches","ê±°ì "],["donate","ê¸°ì¦"],["info","ì •ë³´"],["law","ë²•ì•ˆ"],["faq","FAQ"]
    ];

    // ======================= ê³µí†µ ìœ í‹¸ =======================
    function show(tab){
      state.active = tab;
      sections.forEach(s => { $(s).hidden = (s !== tab); });
      // íƒ­ í™œì„±í™”
      [...tabsDesktop.querySelectorAll("button"), ...bottomNav.querySelectorAll("button")].forEach(btn => {
        btn.classList.toggle("active", btn.dataset.tab === tab);
      });
      if (tab === "search") qInput?.focus({ preventScroll:true });
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
    function fmtPoints(n){ return n.toLocaleString() + "p"; }

    // ======================= íƒ­/ë‚´ë¹„ ë Œë” =======================
    function renderTabs(){
      // ë°ìŠ¤í¬í†± ìƒë‹¨
      tabsDesktop.innerHTML = "";
      TAB_ITEMS.forEach(([k,label])=>{
        const b = document.createElement("button");
        b.className = "chip" + (state.active===k ? " active":"");
        b.dataset.tab = k; b.textContent = label;
        b.addEventListener("click", ()=>show(k));
        tabsDesktop.appendChild(b);
      });
      // ëª¨ë°”ì¼ í•˜ë‹¨ (ëŒ€í‘œ 5ê°œ)
      const MOBILE = [["home","í™ˆ"],["search","ê²€ìƒ‰"],["branches","ê±°ì "],["donate","ê¸°ì¦"],["faq","FAQ"]];
      bottomNav.innerHTML = "";
      MOBILE.forEach(([k,label])=>{
        const b = document.createElement("button");
        b.className = "tab-btn" + (state.active===k ? " active":"");
        b.dataset.tab = k; b.textContent = label;
        b.addEventListener("click", ()=>show(k));
        bottomNav.appendChild(b);
      });
    }

    // ======================= í¬ì¸íŠ¸/í—¤ë” =======================
    function updateHeader(){ pointsVal.textContent = fmtPoints(state.points); }

    // ======================= ê²€ìƒ‰/ì¹´í…Œê³ ë¦¬/ê²°ê³¼ =======================
    function renderCategories(){
      // ì¼ë°˜ ë¶„ì•¼
      categoriesWrap.innerHTML = "";
      const all = document.createElement("button");
      all.className = "chip" + (!state.category ? " active": "");
      all.textContent = "ì „ì²´";
      all.addEventListener("click", ()=>{ state.category=null; renderCategories(); renderResults(); });
      categoriesWrap.appendChild(all);
      CATEGORIES.forEach(c=>{
        const chip = document.createElement("button");
        chip.className = "chip" + (state.category===c ? " active": "");
        chip.textContent = c;
        chip.addEventListener("click", ()=>{ state.category=c; renderCategories(); renderResults(); });
        categoriesWrap.appendChild(chip);
      });

      // ì‹­ì§„ë¶„ë¥˜ ëŒ€ë¥˜
      ddcCatsWrap.innerHTML = "";
      const allD = document.createElement("button");
      allD.className = "chip" + (!state.ddc ? " active": "");
      allD.textContent = "ì „ì²´";
      allD.addEventListener("click", ()=>{ state.ddc=null; renderDdc(); renderResults(); });
      ddcCatsWrap.appendChild(allD);

      DDC_TOP.forEach(d=>{
        const chip = document.createElement("button");
        chip.className = "chip" + (state.ddc===d.code ? " active": "");
        chip.textContent = `${d.code} ${d.label}`;
        chip.title = "í•´ë‹¹ ëŒ€ë¥˜(000~900) í¬í•¨";
        chip.addEventListener("click", ()=>{ state.ddc=d.code; renderDdc(); renderResults(); });
        ddcCatsWrap.appendChild(chip);
      });
    }
    function renderDdc(){
      [...ddcCatsWrap.children].forEach(btn=>{
        if(!btn.dataset) return;
      });
    }
    function filteredBooks(){
      const q = state.query.trim().toLowerCase();
      return BOOKS.filter(b=>{
        const catOk = state.category ? b.category===state.category : true;
        const ddcOk = state.ddc ? String(b.ddc).startsWith(state.ddc[0]) && b.ddc.startsWith(state.ddc) || b.ddc.startsWith(state.ddc) : true;
        const qOk = !q ? true : [b.title,b.author,String(b.year),b.category,b.ddc].join(" ").toLowerCase().includes(q);
        return catOk && ddcOk && qOk;
      });
    }
    function renderResults(){
      const data = filteredBooks();
      resultsWrap.innerHTML = "";
      data.forEach(b=>{
        const art = document.createElement("article");
        art.className = "card book";
        art.innerHTML = `
          <img src="${b.cover}" alt="${b.title} í‘œì§€" loading="lazy" width="1200" height="180" style="height:180px; width:100%; object-fit:cover">
          <div class="meta">
            <h3>${b.title}</h3>
            <div class="meta-sub">${b.author} Â· ${b.year} Â· ${b.category} Â· ìƒíƒœ ${b.condition} Â· <b>DDC ${b.ddc}</b></div>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px">
              <button class="btn ${state.selected.has(b.id) ? "primary": ""}" data-id="${b.id}">
                ${state.selected.has(b.id) ? "ì„ íƒë¨" : "ì„ íƒ"}
              </button>
              <span class="meta-sub">í¬ì¸íŠ¸ ê²°ì œ ê°€ëŠ¥</span>
            </div>
          </div>
        `;
        art.querySelector("button").addEventListener("click", ()=>{
          if (state.selected.has(b.id)) state.selected.delete(b.id);
          else {
            if (state.selected.size >= 3) { alert("ìµœëŒ€ 3ê¶Œê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆì–´ìš”."); return; }
            state.selected.add(b.id);
          }
          renderResults(); updateBorrowButton();
        });
        resultsWrap.appendChild(art);
      });
    }
    function updateBorrowButton(){
      const can = state.selected.size > 0 && state.selected.size <= 3 && state.points >= 100;
      borrowBtn.disabled = !can;
    }

    // ======================= ë­í¬/ê¸°ë¶€ì =======================
    function renderRanks(){
      const make = (list, root) => {
        root.innerHTML = "";
        list.slice(0,5).forEach(([name, val], i)=>{
          const li = document.createElement("li");
          li.innerHTML = `<span>${i+1}. ${name}</span><b>${val}</b>`;
          root.appendChild(li);
        });
      };
      make(POPULAR_LOANS, rankLoansEl);
      make(POPULAR_SALES, rankSalesEl);
      make(MONTH_DONORS, rankDonorsEl);
    }

    // ======================= ê±°ì /ê¸°ì¦ =======================
    function renderBranches(){
      branchList.innerHTML = "";
      branchSel.innerHTML = "";
      BRANCHES.forEach(b=>{
        const card = document.createElement("article");
        card.className = "card";
        card.style.padding = "14px";
        card.innerHTML = `
          <h4 style="margin:0 0 6px; font-size:18px; font-weight:900">${b.name}</h4>
          <div style="color:var(--muted); font-size:14px">${b.address}</div>
          <div style="color:var(--muted); font-size:14px">${b.hours}</div>
          <div style="color:var(--muted); font-size:14px">${b.phone}</div>
          <div style="display:flex; gap:8px; margin-top:10px">
            <button class="btn primary" aria-label="${b.name} ê¸¸ì°¾ê¸°" data-map="${encodeURIComponent(b.address)}">ê¸¸ì°¾ê¸°</button>
            <button class="btn" aria-label="${b.name} ì¬ê³  ë³´ê¸°">ì¬ê³  ë³´ê¸°</button>
          </div>
        `;
        const goBtn = card.querySelector("button[data-map]");
        goBtn.addEventListener("click", ()=>{
          const q = goBtn.getAttribute("data-map");
          const searchUrl = `https://www.openstreetmap.org/search?query=${q}`;
          mapFrame.src = searchUrl; // ì¢Œí‘œê°€ ì—†ìœ¼ë¯€ë¡œ ê²€ìƒ‰ í˜ì´ì§€ í”„ë¦¬ë·°
          mapAddr.textContent = decodeURIComponent(q);
          openMapNew.href = searchUrl;
          mapModal.classList.add("open");
        });
        branchList.appendChild(card);

        const opt = document.createElement("option");
        opt.value = b.id; opt.textContent = b.name;
        branchSel.appendChild(opt);
      });
    }

    // ======================= ëª¨ë‹¬ ë¡œì§ =======================
    $("borrowBtn").addEventListener("click", ()=> {
      const n = state.selected.size;
      $("borrowDesc").innerHTML =
        `1íšŒ ì…ì¥ ì‹œ <b>100 í¬ì¸íŠ¸</b>ë¡œ <b>ë‹¹ì¼ ìµœëŒ€ 3ê¶Œ</b>ê¹Œì§€ ì†Œì¥/ëŒ€ì—¬í•  ìˆ˜ ìˆì–´ìš”. ì„ íƒí•œ ë„ì„œ ìˆ˜: ${n}ê¶Œ.`;
      borrowModal.classList.add("open");
    });
    cancelBorrow.addEventListener("click", ()=> borrowModal.classList.remove("open"));
    confirmBorrow.addEventListener("click", ()=>{
      if (state.points < 100) { alert("í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤."); return; }
      state.points -= 100;
      state.selected.clear();
      updateHeader(); renderResults(); updateBorrowButton();
      borrowModal.classList.remove("open");
      alert("ëŒ€ì—¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. 100 í¬ì¸íŠ¸ê°€ ì°¨ê°ë˜ì—ˆì–´ìš”.");
    });

    // ì§€ë„
    closeMap.addEventListener("click", ()=> mapModal.classList.remove("open"));

    // ======================= ì´ë²¤íŠ¸ =======================
    $("goSearch")?.addEventListener?.("click", ()=>show("search"));
    $("q").addEventListener("input", (e)=>{ state.query = e.target.value; renderResults(); });
    add100Btn.addEventListener("click", ()=>{ state.points += 100; updateHeader(); });
    ctaSearchBtn.addEventListener("click", ()=>show("search"));
    donateForm.addEventListener("submit", (e)=>{
      e.preventDefault();
      donateForm.reset();
      donateDone.hidden = false;
      window.setTimeout(()=> donateDone.hidden = true, 4000);
    });

    // ======================= ì´ˆê¸° ë Œë” =======================
    function init(){
      yearEl.textContent = new Date().getFullYear();
      renderTabs();
      updateHeader();
      renderCategories();
      renderResults();
      renderRanks();
      renderBranches();
      show(state.active);
    }
    document.addEventListener("visibilitychange", ()=> {
      document.body.style.paddingBottom = getComputedStyle($("bottomNav")).height;
    });
    init();
  </script>
</body>
</html>
